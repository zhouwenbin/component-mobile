<p>141环境：</p>
<p>grunt build:prd
cd dist
tar -cvf dist.tar ./*
scp dist.tar admin@10.32.156.141:/home/admin/h5
ssh admin@10.32.156.141
cd h5
tar -xvf dist.tar</p>
<p>123环境：
1、执行打包。进入haitao-b2c-web目录执行如下命令</p>
<pre><code>```
grunt build:prd
```

grunt hybrid:order:1.0.2
</code></pre><p>2、文件压缩。进入dist目录，执行zip压缩</p>
<pre><code>```
cd dist
zip -r dist.zip ./*
```
</code></pre><p>3、文件上传。文件上传到jiyanliang用户(密码：jiyanliang2)</p>
<pre><code>```
scp dist.zip jiyanliang@115.28.235.112:/home/jiyanliang
```

scp dist.zip admin@10.32.156.141:/home/admin
</code></pre><p>4、文件拷贝。使用jiyanliang用户登录开发环境115.28.235.112，执行如下命令</p>
<pre><code>```
ssh jiyanliang@115.28.235.112
scp dist.zip jiyanliang@10.144.128.222:/home/jiyanliang

ssh jiyanliang@10.144.128.222
sudo cp dist.zip /home/admin/h5
```

ssh admin@10.32.156.141
</code></pre><p>5、文件解压。切换到admin用户下，进入h5目录后，确认有dist文件，使用admin用户执行解压</p>
<pre><code>```
sudo su admin
cd
cd h5
unzip -o -d /home/admin/h5 dist.zip
```

unzip -o -d /home/admin/statics dist.zip
</code></pre><hr>
<p>zepto的各种坑：</p>
<p>1、编译zepto(有的有顺序，建议这个顺序即可):
MODULES=&quot;zepto event ajax form ie detect fx fx_methods assets data deferred callbacks selector touch gesture stack ios3&quot; npm run-script dist</p>
<p>2、在</p>
<pre><code>```
window.Zepto = Zepto
&#39;$&#39; in window || (window.$ = Zepto)
```
</code></pre><p>后增加如下代码，以便支持requirejs</p>
<pre><code>```
if ( typeof define === &quot;function&quot; &amp;&amp; define.amd ) {
    define( &quot;zepto&quot;, [], function () { return Zepto; } );
}
```
</code></pre><p>3、加入如下代码，以支持微信的滑动</p>
<pre><code>```
if (touch.x2 &amp;&amp; Math.abs(touch.x1 - touch.x2) &gt; 10){
      e.preventDefault()
    }
```
</code></pre><p>在如下方法中增加</p>
<pre><code>```
.on(&#39;touchmove MSPointerMove pointermove&#39;, function(e){
    if((_isPointerType = isPointerEventType(e, &#39;move&#39;)) &amp;&amp;
      !isPrimaryTouch(e)) return
    firstTouch = _isPointerType ? e : e.touches[0]
    cancelLongTap()
    touch.x2 = firstTouch.pageX
    touch.y2 = firstTouch.pageY

    deltaX += Math.abs(touch.x1 - touch.x2)
    deltaY += Math.abs(touch.y1 - touch.y2)

    if (touch.x2 &amp;&amp; Math.abs(touch.x1 - touch.x2) &gt; 10){
      e.preventDefault()
    }
  })
```
</code></pre><p>4、因IOS在第三方输入法下不支持onkeyup事件，所以需要使用oninput进行代替
  <a href="http://segmentfault.com/q/1010000002608898">http://segmentfault.com/q/1010000002608898</a></p>
<pre><code>```
$(&quot;#user-name&quot;)[0].oninput = function() {
      that.checkusername();
    };
```
</code></pre>